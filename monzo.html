<html>
  <head>
    <script src="test-data.js"></script>
    <script src="monzo.js"></script>
    <script>
      window.onload = function () {
        const GOAL = 250000;
        const PLEDGE_VALUES = [10,20,50,100,250,500,1000];
        const TEST_DATA = PD.sample(PLEDGE_VALUES, 10000, true, [7,6,5,4,3,2,1]);

        var pledgedDiv = document.getElementById("pledged");
        var chosenDiv = document.getElementById("chosen");
        var calcButton = document.getElementById("calculate");
        var recalcButton = document.getElementById("recalculate");

        monzo.initialiseVariables(GOAL, PLEDGE_VALUES, TEST_DATA);

        pledgedDiv.innerHTML = monzo.getAllPledgesTotal();

        calcButton.onclick = function () {
          monzo.chooseSuccessfulApplicants();
          chosenDiv.innerHTML = monzo.getRunningTotal();
          recalcButton.disabled = false;
        };

        recalcButton.onclick = function () {
          var percentage = document.getElementById("failed").value;
          monzo.removeFailedApplicants(percentage / 100);
          monzo.repopulateSuccessfulApplicants();
          pledgedDiv.innerHTML = monzo.getAllPledgesTotal();
          chosenDiv.innerHTML = monzo.getRunningTotal();
        };
      }
    </script>
  </head>

  <body>
    <h1>Monzo Crowdfund</h1>

    <h2>Pledged</h2>
    <div id="pledged"></div>

    <h2>Chosen</h2>
    <div id="chosen">???</div>
    <button id="calculate" type="button">Calculate</button>

    <p>
      <label for="failed">Percentage of failed pledges:</label>
      <input id="failed" type="text" />
      <button id="recalculate" disabled=true>Recalculate</button>
    </p>
  </body>
</html>
